/*
 *			db/Cakefile
 *
 *  This Cakefile is for a recipient machine.
 *  The function is to take the distributed .asc files, and
 *  create the local binary form in .g files.
 *
 *  The STATIC_PRODUCTS definition will cause special things to
 *  happen in the "inst-dist" rule, so that the ASCII files
 *  get into the distribution directory.
 *  What is still missing is some automation to generate the
 *  .asc files from updated binary .g files on the master machine,
 *  but of course, it is hard to know which directory to look in,
 *  so for now this will remain a manual process.
 */

#define PRODUCTS	bldg391.g crod.g demo.g \
	ktank.g moss.g prim.g \
	star.g truck.g world.g cube.g axis.g \
	woodsman.g
#define STATIC_PRODUCTS	bldg391.asc crod.asc demo.asc \
	ktank.asc moss.asc prim.asc \
	star.asc truck.asc world.asc cube.asc axis.asc \
	woodsman.asc

#define SRCDIR	db
#define FILES	/**/
#define	SRCSUFF	.asc
#define MANSECTION	9

#include "../Cakefile.defs"

/* Prevent actual installation */
#define DONT_INSTALL	1
#undef BINDIR
#define BINDIR	/tmp
#define AFTERINSTALL	rm

/* Default rule */
everything&::	PRODUCTS

#if defined(NFS)
#	define	CONV	../.conv.MTYPE/asc2g
#else
#	define	CONV	../conv/asc2g
#endif

%.g:	../SRCDIR/%.asc	/tmp/asc2g		if exist ../SRCDIR/%.asc
	CONV < ../SRCDIR/%.asc > %.g

#include "../Cakefile.rules"
